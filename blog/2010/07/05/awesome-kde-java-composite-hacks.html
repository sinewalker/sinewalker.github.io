<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<base href="http://milosophical.me/blog/2010/07/05/awesome-kde-java-composite-hacks.html">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Awesome KDE, Java composite hacks | Milosophical Me</title>
<link href="../../../../assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="../../../../assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="../../../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../../../assets/css/colorbox.css" rel="stylesheet" type="text/css">
<link href="../../../../assets/css/theme.css" rel="stylesheet" type="text/css">
<link href="../../../../assets/css/custom.css" rel="stylesheet" type="text/css">
<link href="../../../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../../../rss.xml">
<link rel="canonical" href="http://milosophical.me/blog/2010/07/05/awesome-kde-java-composite-hacks.html">
<!--[if lt IE 9]><script src="../../../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Michael Lockhart">
<link rel="prev" href="../../05/31/java-concurrency-links.html" title="Java concurrency links" type="text/html">
<link rel="next" href="../09/what-happened-to-my-ctrl-zoom-in-xorg.html" title="What happened to my Ctrl-+/- zoom in Xorg?" type="text/html">
<meta property="og:site_name" content="Milosophical Me">
<meta property="og:title" content="Awesome KDE, Java composite hacks">
<meta property="og:url" content="http://milosophical.me/blog/2010/07/05/awesome-kde-java-composite-hacks.html">
<meta property="og:description" content="I've been experimenting with the awesome tiling window manager as a replacement to KDE's kwin, and I've managed to hack together a recipe for getting them up an running. It's surprisingly simple, alth">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2010-07-05T14:54:32+10:00">
<meta property="article:tag" content="awesome">
<meta property="article:tag" content="desktop">
<meta property="article:tag" content="geek">
<meta property="article:tag" content="hacking">
<meta property="article:tag" content="how-to">
<meta property="article:tag" content="KDE">
<meta property="article:tag" content="useability">
<meta property="article:tag" content="xcompmgr">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://milosophical.me/">

                <span id="blog-title">Milosophical Me</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../../index.html">Blog</a>
                </li>
<li>
<a href="../../../../archive/archive.html">Archive</a>
                </li>
<li>
<a href="../../../../tags/index.html">Tags</a>
                </li>
<li>
<a href="../../../../pg/index.html">Codex</a>
                </li>
<li>
<a href="../../../../pixels/index.html">Pixels</a>
            </li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Social <b class="caret"></b></a>
            <ul class="dropdown-menu">
<li>
<a href="https://plus.google.com/+MichaelLockhart/posts">Microblog</a>
                    </li>
<li>
<a href="https://www.facebook.com/sinewalker">Facebook</a>
                    </li>
<li>
<a href="mailto:sinewalker@gmail.com">Email</a>
            </li>
</ul>
</li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Code <b class="caret"></b></a>
            <ul class="dropdown-menu">
<li>
<a href="https://github.com/sinewalker">GitHub</a>
                    </li>
<li>
<a href="https://bitbucket.com/sinewalker">Bitbucket</a>
                    </li>
<li>
<a href="https://codepen.io/sinewalker/">Codepen</a>
                    </li>
<li class="active">
<a href="#"> <span class="sr-only">(active)</span></a>
                    </li>
<li>
<a href="https://sourceforge.net/u/sinewalker/profile/">SourceForge</a>
            </li>
</ul>
</li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">About <b class="caret"></b></a>
            <ul class="dropdown-menu">
<li>
<a href="https://about.me/mikelockhart">About.me</a>
                    </li>
<li>
<a href="../../../../pg/colophon.html">About this site</a>
                    </li>
<li>
<a href="https://calendar.google.com/calendar/embed?src=sinewalker@gmail.com&amp;ctz=Australia/Sydney/">My calendar</a>
                    </li>
<li>
<a href="https://www.linkedin.com/in/mikelockhart">LinkedIn</a>
                    </li>
<li>
<a href="http://stackoverflow.com/users/776953/mike">Stack Overflow</a>
            </li>
</ul>
</li>
<li>
<a href="../../../../rss.xml">RSS</a>

                
            </li>
</ul>
<!-- DuckDuckGo custom search --><form method="get" id="search" action="https://duckduckgo.com/" class="navbar-form navbar-right" role="search">
<input type="hidden" name="sites" value="http://milosophical.me/"><input type="hidden" name="k8" value="#444444"><input type="hidden" name="k9" value="#D51920"><input type="hidden" name="kt" value="h"><input type="text" name="q" maxlength="255" placeholder="Search…" class="form-control"><input type="submit" value="DuckDuckGo Search" style="visibility: hidden;">
</form>
<!-- End of custom search -->


            <ul class="nav navbar-nav navbar-right">
<li>
    <a href="awesome-kde-java-composite-hacks.wp" id="sourcelink">Source</a>
    </li>

                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">Awesome KDE, Java composite hacks</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                    <a href="../../../../authors/michael-lockhart.html">Michael Lockhart</a>
            </span></p>
            <p class="dateline"><a href="#" rel="bookmark"><time class="published dt-published" datetime="2010-07-05T14:54:32+10:00" itemprop="datePublished" title="2010-07-05 14:54">2010-07-05 14:54</time></a></p>
            
        <p class="sourceline"><a href="awesome-kde-java-composite-hacks.wp" id="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>I've been experimenting with the <a title="This is gonna be LEGEN ... wait for it ... DARY" href="http://awesome.naquadah.org/">awesome</a> <a title="Wikipedia" href="http://en.wikipedia.org/wiki/Tiling_window_manager">tiling window manager</a> as a replacement to KDE's <a title="Wikipedia" href="http://en.wikipedia.org/wiki/KWin">kwin</a>, and I've managed to hack together a recipe for getting them up an running. It's surprisingly simple, although the learing curve was a little steep.
</p>
<p>
This post documents what I've done to get things working nicely with the basic awesome config. No customisations here, see the <a title="Awesome's wiki" href="http://awesome.naquadah.org/wiki/Main_Page">awesome wiki</a> for some <a title="Customising Awesome" href="http://awesome.naquadah.org/wiki/Main_Page#Customization">ideas</a>.
</p>
<!-- TEASER_END -->

<h2>Rationale</h2>
<p>
After living in emacs for a few years I've come to appreciate it's <a title="What's LCARS?" href="http://memory-alpha.org/wiki/LCARS">LCARS</a> style of window panels, so I started to investigate arranging windows at a more global level in my X desktop. I discovered <a title="Wikipedia" href="http://en.wikipedia.org/wiki/Tiling_window_manager">tiling window managers</a> and started researching them. I decided I want a light-weight, no-fuss tiling window manager for many reasons, not least being that overlapping windows become a mess, and the computer should really be taking care of arranging windows for me.  So I investigated several, narrowing down to <a title="Written in Haskel, not too bad" href="http://xmonad.org">xmonad</a>, <a title="Window Manager Improved 2" href="http://wmii.suckless.org">wmii</a> and finally settling on <a title="This is gonna be LEGEN ... wait for it ... DARY" href="http://awesome.naquadah.org/">awesome</a>.
</p>

<p>
However I still like the general KDE environment with all it's facilities like <a title="The semantic desktop" href="http://nepomuk.semanticdesktop.org/xwiki/bin/view/Main1/">Nepomuk</a>, <a title="Plasma" href="http://plasma.kde.org/">Plasma</a>, the <a title="KDE Desktop COmmunications Protocol" href="http://developer.kde.org/documentation/other/dcop.html">DCOP</a>, knotify  integration, <a title="KDE Plasma desktop Run Command" href="http://userbase.kde.org/Plasma/Krunner">krunner</a>, hooks to Firefox and the trash can and so on -- all tools I can't live without. So I don't want to give  up KDE altogether just to have a better window manager. What I really want to do is run the KDE environment, but use awesome instead of kwin to manage my windows. If I can keep the eye-candy of transparent windows then that'd be a bonus.
</p>

<p>
After a week-end of research and hacking, here are my results.
</p>
<h2>Installing awesome</h2>
<p>
This is a cinch on openSUSE, and probably also on most distro's.  In openSUSE I just used the <a title="Webpin integrated into Yast" href="http://en.opensuse.org/YaST/Research/YaST_Interface_for_Webpin">Webpin</a> module in YaST to find <a title="awesome packages in the OBS" href="https://build.opensuse.org/search/search">a package</a> on the <a title="OpenSUSE Build Service - for end-users, this is akin to Ubunto/Debian Universe" href="https://build.opensuse.org/">OBS</a> and then installed that directly from the Webpin module, which added the repository and downloaded and installed the packages for me.
</p>

<p>
Once installed, this gives an additional Session type on the kdm login screen, which is neat for testing or using awesome by itself, but when you launch KDE it's still the same (as you would expect!)
</p>
<h2>Replacing the KDE window manager</h2>
<p>
After some searching on a few forums I found that KDE's window manager can be set by putting the following into a script in the per-user KDE environment directory (<code>~/.kde4/env</code> for KDE4)
</p>
<p style="padding-left:30px;"><code>KDEWM=/usr/bin/awesome</code></p>
<p>
This has the advantage that it only affects you, not everyone on the system who runs KDE.  Also it's easy to turn off and get the original kwin back if you want to.  I may look into adding KDE+awesome as a session type and then having a separate section in my <code>~/.xinitrc</code> in the future if I'll be swapping back more often.  I don't anticipate it today though.
</p>
<h2>Fixing Java</h2>
<p>
There is a <a title="Java reparinting window bug" href="http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6429775">bug</a> in Java 1.5 and 1.6 where it makes protocol assumptions that are not true in non-reparanting window managers (something along those lines anyway).  It results in Java GUIs appearing as just a grey box in certain window managers like xgl, dwm, wmii, xmonad and awesome. <a title="awesome tip to fix grey Java windows" href="http://awesome.naquadah.org/wiki/Problems_with_Java">Apparently</a> this'll be fixed in Java 1.7. In the mean-time, to fix it for 1.5 and 1.6 you can install a utility called <a title="wmname" href="http://tools.suckless.org/wmname">wmname</a> (I used Webpin again) and then put this in a script to run at start-up (i.e. in <code>~/.kde4/Autostart</code>)
</p>
<pre style="padding-left:30px;"><code>#!/bin/sh
/usr/bin/wmname LG3D
</code></pre>
<p>
The "LG3D" window manager name above is one of the strings that 1.5 and 1.6 JVMs look for and change their behavior if found. This value is the name of the<a title="Wikipedia" href="http://en.wikipedia.org/wiki/Project_Looking_Glass"> LookingGlass3D</a> window manager, by Sun. Appreciate the irony...
</p>
<h2>Composite effects (transparency and shadows)</h2>
<p>
I found <a title="explains xcompmgr and setting it up" href="http://wiki.archlinux.org/index.php/Xcompmgr">this link</a> on the ArchLinux wiki. It's very useful and describes how to enable <a title="Enabling composite extension in Xorg 7.1+" href="http://wiki.archlinux.org/index.php/Composite">composite</a> effects by default in your Xorg, and includes a <a title="start/stop xcompmgr" href="http://wiki.archlinux.org/index.php/Xcompmgr#Starting.2FStopping_xcompmgr_on_Demand">script</a> to turn effects on and off (quite useful on my aging AthlonXP  + Radeon, which can <em>only just</em> handle the effects, but works nice and snappy without them).
</p>

<p>
With all this done I have a nice stable and useful desktop which I can begin to tweak when I get a chance to play with the Lua language that Awesome is configured with. More toys to play with :)</p>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../../../tags/awesome.html" rel="tag">awesome</a></li>
            <li><a class="tag p-category" href="../../../../tags/desktop.html" rel="tag">desktop</a></li>
            <li><a class="tag p-category" href="../../../../tags/geek.html" rel="tag">geek</a></li>
            <li><a class="tag p-category" href="../../../../tags/hacking.html" rel="tag">hacking</a></li>
            <li><a class="tag p-category" href="../../../../tags/how-to.html" rel="tag">how-to</a></li>
            <li><a class="tag p-category" href="../../../../tags/kde.html" rel="tag">KDE</a></li>
            <li><a class="tag p-category" href="../../../../tags/useability.html" rel="tag">useability</a></li>
            <li><a class="tag p-category" href="../../../../tags/xcompmgr.html" rel="tag">xcompmgr</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../../05/31/java-concurrency-links.html" rel="prev" title="Java concurrency links">Previous post</a>
            </li>
            <li class="next">
                <a href="../09/what-happened-to-my-ctrl-zoom-in-xorg.html" rel="next" title="What happened to my Ctrl-+/- zoom in Xorg?">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer"><hr>Contents Copyright © 
<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">
<img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/80x15.png"></a> 2005 — 2016         <a href="mailto:sinewalker@gmail.com">Michael Lockhart</a>. Powered by <a href="https://getnikola.com" rel="nofollow"><img src="../../../../img/nikola.png" alt="Nikola"></a>, <a href="https://github.com/syl20bnr/spacemacs"><img src="https://cdn.rawgit.com/syl20bnr/spacemacs/442d025779da2f62fc86c2082703697714db6514/assets/spacemacs-badge.svg" alt="built with Spacemacs"></a>
            
        </footer>
</div>
</div>


            <script src="../../../../assets/js/jquery.min.js"></script><script src="../../../../assets/js/bootstrap.min.js"></script><script src="../../../../assets/js/moment-with-locales.min.js"></script><script src="../../../../assets/js/fancydates.js"></script><script src="../../../../assets/js/jquery.colorbox-min.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');  ga('create', 'UA-65364237-1', 'auto');  ga('send', 'pageview');</script>
</body>
</html>
