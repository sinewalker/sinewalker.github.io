<html><body><p>In vanila SuSE 10.0, safely removing a <a title="Universal Serial Bus" href="http://en.wikipedia.org/wiki/USB">USB</a> <a title="Hey, I like my term better than the one's other people have come up with..." href="http://en.wikipedia.org/wiki/USB_flash_drive#Etymology">frob</a> can be a trial for non-root users.  It's a shame, but I've found a fix that I'm 95% happy with.
</p>

<!-- TEASER_END -->
<p>Here's a screen shot showing how easy it is to remove a USB device in KDE (I wish Windows was this easy, instead of having to play "hunt for the Safely Remove icon in the Systray...")
</p>

<p>
<a title="photo sharing" href="http://www.flickr.com/photos/lockhart/202572577/"><img src="http://static.flickr.com/66/202572577_feca535e56_m.jpg" alt=""></a><br/>

<a href="http://www.flickr.com/photos/lockhart/202572577/">"Safely Remove" a USB frob under SuSE/KDE</a></p>
<p>
Unfortunately, it doesn't work.  Instead of the icon disappearing (indicating you can pull out the frob safely), you get a nasty error:
</p>

<p>
<a title="photo sharing" href="http://www.flickr.com/photos/lockhart/202572575/"><img src="http://static.flickr.com/25/202572575_35fb9cda79_o.png" alt=""></a><br/>

<a href="http://www.flickr.com/photos/lockhart/202572575/">Umount - mtab entry missing error</a></p>
<p>
After reading a few man pages and surfing for a bit, I found out that this error is generated by the <code>umount</code> command.  The man page for <code>mount</code> actually recommends replacing the <code>/etc/mtab</code> file with a symlink to <code>/proc/mounts</code> under Linux.  So I did that and tried again.  Here's what I got:
</p>

<p>
<a title="photo sharing" href="http://www.flickr.com/photos/lockhart/202572576/"><img src="http://static.flickr.com/74/202572576_973f7f47d0_o.png" alt=""></a><br/>

<a href="http://www.flickr.com/photos/lockhart/202572576/">Umount - fstab entry missing error</a></p>
<p>
So, because <code>kio_media_mounthelper</code> has helpfully mounted the frob under a mountpoint with the same name as the VFAT volume label (which is actually pretty cool!), <code>umount</code> can't find this entry in <code>/etc/fstab</code> (not so cool).
</p>

<p>
<code>/etc/fstab</code> is not supposed to be updated by machines, only people, so the work-around is to manually add entries for all of my USB frobs.  I only have two, so it's fairly easy:

</p><blockquote>

<pre><code>#MJL20060731 - the following were added to try to appease umount/kio_media_mounthelper for USB frobs:

/dev/sda1            /media/D_CHIP_00    subfs      noauto,fs=usbfs,users,nosuid 0 0
/dev/sda1            /media/D_CHIP_01    subfs      noauto,fs=usbfs,users,nosuid 0 0</code></pre>
</blockquote>
<p>
Note:— I've done two things here:  added an entry for each of the USB frobs onto the <code>/dev/sda1</code> device (which is type <code>subfs</code>, because SuSE uses <a title="submount home on SourceForge" href="http://www.google.com.au/url?sa=t&amp;ct=res&amp;cd=1&amp;url=http%3A%2F%2Fsubmount.sourceforge.net%2F&amp;ei=Zp3ORJn1MIeKsAKp8rWtBA&amp;sig2=m6wLzB71BjAKWrwSKUU8Mg">submount</a> to mount removeable devices), and make it so that normal <code>users</code> can unmount.  It's also worth adding the <code>users</code> flag to other removeable devices too, such as CD-ROMs, since <code>umount</code> will complain about your not being root without it…
</p>

<p>
I see three problems with this:
</p>
<ol>
	<li>Any new frob I buy (or if I rename a frob volume) will need an entry in <code>/etc/fstab</code> before normal users an safely unmount it. Ugly.</li>
	<li>You have to be root to edit <code>/etc/fstab</code>, so only <em>I </em>can add new frobs to the list. Inconvinient.</li>
	<li>The way I've edited <code>/etc/fstab</code> to have both frobs on the one device, means I can only use one at a time.</li>
</ol>
<p>
A work-around for the 1st and 2nd gripes is to add a third entry to <code>/etc/fstab</code> with a generic label, and always label my USB frobs that way.  Not sure if that is better or not.
</p>

<p>
So, I've found my first SuSE gripe.  It's nothing major, and it was not a big problem to find a solution or work-around that is actually liveable for day-to-day tasks and only becomes an issue occasionally.
</p>


<hr><strong> 2007-03-09T10:42+1100 Update:</strong> Works okay in openSUSE 10.2, don't have to do anything with <code>/etc/fstab</code></body></html>
