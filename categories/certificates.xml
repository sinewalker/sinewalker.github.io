<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/"><channel><title>Milosophical Me (certificates)</title><link>http://milosophical.me/</link><description></description><language>en</language><lastBuildDate>Wed, 28 Jan 2015 08:58:44 GMT</lastBuildDate><generator>http://getnikola.com/</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Fixing Java CA Certificates on openSUSE</title><link>http://milosophical.me/blog/2013/05/24/fixing-java-ca-certificates-on-opensuse.html</link><dc:creator>Mike Lockhart</dc:creator><description>&lt;p&gt;Recently switched back to openSUSE after a brief stint with Ubuntu. I guess you need to try other things out to know how good you have it, eh?Â  Anyway, I'm playing with &lt;a href="https://github.com/technomancy/leiningen" title="Leiningen build tool for Clojure"&gt;Leiningen&lt;/a&gt; and &lt;a href="https://github.com/quil/quil" title="Quil Clojure wrapper for Processing"&gt;Quil&lt;/a&gt;, but for some reason or other, I could not get Leiningen to self-install, because of an exception:
&lt;/p&gt;&lt;pre style="text-align:center;"&gt;java.security.KeyStoreException: problem accessing trust storejava.io.IOException: Invalid keystore format&lt;/pre&gt;

It turns out that the java keystore is somehow corrupt on OpenJDK / openSUSE 12.3. Not sure who's at fault, but here's how to fix it.

&lt;!--more--&gt;

&lt;ol&gt;

&lt;li&gt;Become root:

&lt;pre&gt;$ &lt;strong&gt;su -&lt;/strong&gt;

Password:

#&lt;/pre&gt;

&lt;/li&gt;

&lt;li&gt;Verify the certificates file:

&lt;pre&gt;# &lt;strong&gt;file $(readlink /usr/lib64/jvm/java-1.7.0-openjdk/jre/lib/security/cacerts)&lt;/strong&gt;

/var/lib/ca-certificates/java-cacerts: data&lt;/pre&gt;

&lt;/li&gt;

&lt;li&gt;Oops, file should identify this as a Java KeyStore. Must be corrupt. Replace it:

&lt;pre&gt;# &lt;strong&gt;rm /var/lib/ca-certificates/java-cacerts&lt;/strong&gt;

# &lt;strong&gt;/usr/sbin/update-ca-certificates&lt;/strong&gt;

creating /var/lib/ca-certificates/java-cacerts ...

144 added, 0 removed.

creating /var/lib/ca-certificates/gcj-cacerts ...

imporing AffirmTrust_Premium_ECC.pem failed: java.security.spec.InvalidKeySpecException

imporing COMODO_ECC_Certification_Authority.pem failed: java.security.spec.InvalidKeySpecException

imporing GeoTrust_Primary_Certification_Authority_G2.pem failed: java.security.spec.InvalidKeySpecException

imporing VeriSign_Class_3_Public_Primary_Certification_Authority_G4.pem failed: java.security.spec.InvalidKeySpecException

imporing thawte_Primary_Root_CA_G2.pem failed: java.security.spec.InvalidKeySpecException

2 added, 0 removed.&lt;/pre&gt;

&lt;/li&gt;

&lt;li&gt;Hmm, something's up with &lt;em&gt;gcj-cacerts&lt;/em&gt; (not just all those "imporing"s, seems the PEM files are corrupted too?)... Anyway, re-verify the java-cacerts:

&lt;pre&gt;# &lt;strong&gt;file /var/lib/ca-certificates/java-cacerts&lt;/strong&gt;

/var/lib/ca-certificates/java-cacerts: Java KeyStore&lt;/pre&gt;

&lt;/li&gt;

&lt;li&gt;Good to go (sort-of?)&lt;/li&gt;

&lt;/ol&gt;</description><category>certificates</category><category>fix</category><category>hacking</category><category>java</category><category>openSUSE</category><guid>http://milosophical.me/blog/2013/05/24/fixing-java-ca-certificates-on-opensuse.html</guid><pubDate>Fri, 24 May 2013 04:03:15 GMT</pubDate></item></channel></rss>