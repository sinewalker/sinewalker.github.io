// #TODO remember how to use Dot and specify an architecture that's like this

// #       MACINTOSH DEVICE                                                ANDROID DEVICE
// # (password-store Mac) <--Mac SSH key-->  (GitLab) <-- Droid SSH Key --> (password-store Droid)
// #
// #           ^                                                                   ^
// #           |                                                                   |
// #     [pws-GPG-sec] <- {passphrase'}                   {passphrase''} ->  [pws-GPG-sec]
// #
// #  repeats for other devices

// # Passphrases:
// # * for simplicity, passphrase' = passphrase'' but they don't have to.
// # * I opted for a passwordless SSH key to gitlab from the phone.

digraph passwordstorearchitecture {
  PSm [shape="box", style="filled", fillcolor="LightGreen", color="Green" label="password-store Mac"]
  PSd [shape="box", style="filled", fillcolor="LightGreen", color="Green" label="password-store Droid"]
  Git [shape="box", style="dash", color="Red" label="GitLab"]
  GPGM [shape="oval", color = "Orange" label="password-store GPG pub/sec"]
  GPGD [shape="oval", color = "Orange" label="password-store GPG pub/sec"]

  pwA [shape="oval", color = "LightOrange" label="passphrase'"]
  pwB [shape="oval", color = "LightOrange" label="passphrase''"]

  ////

  // proxy

  edge [style=""]
    PSm -> Git   [label="Mac SSH key"]
    Git -> PSm

  edge [style=""]
    PSd -> Git   [label="Droid SSH key"]
    Git -> PSd

  edge [style=""]
    GPGM -> PSm [label="encrypt"]
    PSm -> GPGM [label="decrypt"]

  edge [style=""]
    GPGD -> PSd [label="encrypt"]
    PSd -> GPGD [label="decrypt"]

  pwA -> GPGD
  pwB -> GPGM
}

////
//     // Redirects
//   edge [style=""]
//     wwwNMA -> mNMA [label="mobile\n redirects", color="DeepSkyBlue"]
//     mNMA -> wwwNMA [label="switch\n redirects", color="sienna"]

//   // includes
//   edge [style="dashed", label="includes"]
//     wwwNMA -> common   [color="DeepSkyBlue"]
//     mNMA -> common     [color="sienna"]
//     common -> matrix   [color="DarkViolet"]

//   // matrix
//   edge [style="",color="ForestGreen"]
//     matrix -> matrixFPM
//     matrixFPM -> matrix
//     files -> matrix         [label="downloads"]
//     matrixFPM -> files      [label="uploads"]
//     matrixFPM -> db
//     db -> matrixFPM

//   // logging
//   edge [style="", label="logs"]
//     matrixFPM -> matrixLogs

// }
